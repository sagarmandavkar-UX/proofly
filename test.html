<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Proofly Test Page - All Editable Elements</title>

    <!-- Early theme application to avoid flash: read system preference and set data-theme on the root immediately -->
    <script>
      (function () {
        try {
          const prefersDark =
            window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          const theme = prefersDark ? 'dark' : 'light';
          if (theme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
          } else {
            document.documentElement.removeAttribute('data-theme');
          }
        } catch (e) {
          // ignore - localStorage may be unavailable in some embedded contexts
        }
      })();
    </script>

    <style>
      :root {
        /* light theme variables */
        --bg: #f5f5f5;
        --card: #ffffff;
        --text: #333333;
        --muted: #666666;
        --accent: #1976d2;
        --input-border: #dddddd;
        --placeholder: #999999;
        --info-bg: #e3f2fd;
        --info-text: #1976d2;
      }

      [data-theme='dark'] {
        /* dark theme variables */
        --bg: #0f1720;
        --card: #0b1220;
        --text: #e6eef8;
        --muted: #9aa8bf;
        --accent: #60a5fa;
        --input-border: #233042;
        --placeholder: #7b8aa3;
        --info-bg: #07263b;
        --info-text: #8fc2ff;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: var(--bg);
        color: var(--text);
      }

      .section {
        background: var(--card);
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.06);
      }

      h1 {
        color: var(--text);
        text-align: center;
        /* removed grid layout from h1 - header will handle layout */
        margin: 0;
      }

      .page-header {
        display: grid;
        justify-items: center;
        gap: 10px;
        grid-template-columns: auto 1fr auto;
        align-items: center;
        margin-bottom: 20px;
      }

      h1 img {
        grid-column: 1;
      }
      h1 span {
        grid-column: 2;
      }

      .theme-controls {
        grid-column: 3;
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .theme-toggle {
        width: 40px;
        height: 40px;
        border: 2px solid var(--input-border);
        border-radius: 4px;
        background: var(--card);
      }

      .visually-hidden {
        position: absolute !important;
        height: 1px;
        width: 1px;
        overflow: hidden;
        clip: rect(1px, 1px, 1px, 1px);
        white-space: nowrap;
        border: 0;
        padding: 0;
        margin: -1px;
      }

      h2 {
        color: var(--muted);
        margin-top: 0;
        font-size: 16px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      input[type='text'],
      textarea {
        width: 100%;
        padding: 12px;
        font-size: 16px;
        border: 2px solid var(--input-border);
        border-radius: 4px;
        font-family: inherit;
        box-sizing: border-box;
        color: var(--text);
        background: var(--card);
      }

      textarea {
        min-height: 150px;
        resize: vertical;
      }

      [contenteditable] {
        width: 100%;
        min-height: 150px;
        padding: 12px;
        font-size: 16px;
        border: 2px solid var(--input-border);
        border-radius: 4px;
        background: var(--card);
        box-sizing: border-box;
        color: var(--text);
      }

      [contenteditable]:focus {
        outline: none;
        border-color: var(--accent);
      }

      input:focus,
      textarea:focus {
        outline: none;
        border-color: var(--accent);
      }

      .placeholder {
        color: var(--placeholder);
      }

      .info {
        background: var(--info-bg);
        padding: 12px;
        border-radius: 4px;
        margin-top: 30px;
        font-size: 14px;
        color: var(--info-text);
      }
    </style>
  </head>
  <body>
    <header class="page-header">
      <h1>Proofly Test Page</h1>
      <div class="theme-controls" aria-hidden="false">
        <button
          id="theme-toggle"
          class="theme-toggle"
          aria-pressed="false"
          aria-label="Toggle dark mode"
          title="Toggle dark / light"
        >
          ðŸŒ™
        </button>
      </div>
    </header>

    <div class="section">
      <h2>1. Input Field (text)</h2>
      <label for="test-input" class="visually-hidden">Test input</label>
      <input
        id="test-input"
        type="text"
        placeholder="Type something with speling mistakes here..."
        value="This are a radnom test with typicla errors"
      />
    </div>

    <div class="section">
      <h2>2. Textarea Element</h2>
      <label for="test-textarea" class="visually-hidden">Test textarea</label>
      <textarea
        id="test-textarea"
        placeholder="Type or paste text with grammar and speling mistakes..."
      >
This are a radnom text with a few classic common, and typicla typso and grammar issus. the Proofreader API hopefuly finds them all. Knocking at wood and crossed.</textarea
      >
    </div>

    <div class="section">
      <h2>3. ContentEditable Div</h2>
      <div
        id="test-contenteditable-div"
        contenteditable="plaintext-only"
        data-placeholder="Click here to type with speling and grammer mistakes..."
      >
        This are another test with some obvius mistakes and typicla errors that should be detected
        by the proofreading systm.
      </div>
    </div>

    <div class="section">
      <h2>1. Input Field (text)</h2>
      <label for="test-input2" class="visually-hidden">Test input</label>
      <input
        id="test-input2"
        type="text"
        placeholder="Type something with speling mistakes here..."
        value="This are a radnom test with typicla errors"
      />
    </div>

    <div class="section">
      <h2>2. Textarea Element</h2>
      <label for="test-textarea2" class="visually-hidden">Test textarea</label>
      <textarea
        id="test-textarea2"
        placeholder="Type or paste text with grammar and speling mistakes..."
      >
This are a radnom text with a few classic common, and typicla typso and grammar issus. the Proofreader API hopefuly finds them all. Knocking at wood and crossed.</textarea
      >
    </div>

    <div class="section">
      <h2>3. ContentEditable Div</h2>
      <div
        id="test-contenteditable-div2"
        contenteditable="plaintext-only"
        data-placeholder="Click here to type with speling and grammer mistakes..."
      >
        This are another test with some obvius mistakes and typicla errors that should be detected
        by the proofreading systm.
      </div>
    </div>

    <div class="section">
      <h2>1. Input Field (text)</h2>
      <label for="test-input3" class="visually-hidden">Test input</label>
      <input
        id="test-input3"
        type="text"
        placeholder="Type something with speling mistakes here..."
        value="This are a radnom test with typicla errors"
      />
    </div>

    <div class="section">
      <h2>2. Textarea Element</h2>
      <label for="test-textarea3" class="visually-hidden">Test textarea</label>
      <textarea
        id="test-textarea3"
        placeholder="Type or paste text with grammar and speling mistakes..."
      >
This are a radnom text with a few classic common, and typicla typso and grammar issus. the Proofreader API hopefuly finds them all. Knocking at wood and crossed.</textarea
      >
    </div>

    <div class="section">
      <h2>3. ContentEditable Div</h2>
      <div
        id="test-contenteditable-div3"
        contenteditable="plaintext-only"
        data-placeholder="Click here to type with speling and grammer mistakes..."
      >
        This are another test with some obvius mistakes and typicla errors that should be detected
        by the proofreading systm.
      </div>
    </div>

    <div class="info">
      <strong>Testing Instructions:</strong>
      <ol style="margin: 10px 0; padding-left: 20px">
        <li>Make sure the Proofly extension is loaded in Chrome</li>
        <li>Check the extension icon shows it's active on this page</li>
        <li>Type or edit text in each field above</li>
        <li>Wait 1.5 seconds for proofreading to trigger</li>
        <li>Verify highlights appear correctly on all three element types</li>
        <li>Click on highlights to see issue cards</li>
        <li>Test applying corrections</li>
        <li>Check browser console and extension logs for any errors</li>
      </ol>
    </div>

    <script>
      // Add placeholder behavior for contenteditable
      const contentEditable = document.querySelector('[contenteditable]');
      const placeholder = contentEditable.getAttribute('data-placeholder');

      if (contentEditable.textContent.trim() === '') {
        contentEditable.innerHTML = `<span class="placeholder">${placeholder}</span>`;
      }

      contentEditable.addEventListener('focus', function () {
        if (this.querySelector('.placeholder')) {
          this.textContent = '';
        }
      });

      contentEditable.addEventListener('blur', function () {
        if (this.textContent.trim() === '') {
          this.innerHTML = `<span class="placeholder">${placeholder}</span>`;
        }
      });
    </script>

    <script>
      // Theme management: respects system preference, allows override via toggle, and persists choice in localStorage
      (function () {
        const toggleBtn = document.getElementById('theme-toggle');
        const prefersDarkMQ = window.matchMedia('(prefers-color-scheme: dark)');

        function applyTheme(theme) {
          if (theme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
          } else {
            document.documentElement.removeAttribute('data-theme');
          }
          // update toggle UI
          toggleBtn.setAttribute('aria-pressed', String(theme === 'dark'));
          toggleBtn.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
        }

        function init() {
          // start with system preference
          applyTheme(prefersDarkMQ.matches ? 'dark' : 'light');

          // always listen for system changes and apply them (no persistence)
          if (typeof prefersDarkMQ.addEventListener === 'function') {
            prefersDarkMQ.addEventListener('change', (e) => {
              applyTheme(e.matches ? 'dark' : 'light');
            });
          }

          // toggle behavior: clicking toggles between dark and light for the current session only (no saving)
          toggleBtn.addEventListener('click', () => {
            const currentIsDark = document.documentElement.getAttribute('data-theme') === 'dark';
            const next = currentIsDark ? 'light' : 'dark';
            applyTheme(next);
          });
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', init);
        } else {
          init();
        }
      })();
    </script>
  </body>
</html>
